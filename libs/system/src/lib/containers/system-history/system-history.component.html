<div class="d-flex mt-3 ml-2 px-2 ">
  <div class='d-flex flex-column ml-3 border p-2' style='height: 75vh; width:250px; overflow-y: scroll'>

    <nz-collapse>
      <nz-collapse-panel
        nzHeader='Tìm kiếm'
        nzActive='true'>
        <div [formGroup]='formGroup'>
          <input nz-input class='form-control' type='search' formControlName='search'>
        </div>
      </nz-collapse-panel>
    </nz-collapse>
    <nz-collapse class="mt-2">
      <nz-collapse-panel
        [formGroup]="formGroup"
        nzHeader='Ứng dụng'
        nzActive='true'>
        <nz-select style="width: 100%"
                   nzShowSearch
                   [compareWith]="compareFN"
                   nzPlaceHolder="Chọn ứng dụng"
                   formControlName="appName"
        >
          <nz-option *ngFor="let item of apps" [nzLabel]="item.name" [nzValue]="item.value"></nz-option>
        </nz-select>
      </nz-collapse-panel>
    </nz-collapse>

    <nz-collapse class="mt-2">
      <nz-collapse-panel
        [formGroup]="formGroup"
        nzHeader='Hành động'
        nzActive='true'>
        <nz-select style="width: 100%"
                   nzShowSearch
                   [compareWith]="compareFN"
                   nzPlaceHolder="Chọn hành động"
                   formControlName="activity"
        >
          <nz-option *ngFor="let item of methods" [nzLabel]="item.name" [nzValue]="item.value"></nz-option>
        </nz-select>
      </nz-collapse-panel>
    </nz-collapse>

    <nz-collapse class="mt-2">
      <nz-collapse-panel
        [formGroup]="formGroup"
        nzHeader='Ngày'
        nzActive='true'>
      <nz-date-picker
        class="w-100"
        nzMode="date"
        nzFormat="dd-MM-yyyy"
        formControlName="createdAt"></nz-date-picker>
      </nz-collapse-panel>
    </nz-collapse>
  </div>
  <div style='min-height: 70vh; width: 80vw'>
    <div class='mx-auto px-2'>
      <div class='mt-3 ml-3 font-weight-bold'>
        Tổng: {{total$|async}}
      </div>
      <nz-table
        #tableSystemHistory
        nzShowPagination="false"
        [nzData]="(systemHistory$|async)||[]"
        [nzLoading]="(loading$|async)"
        nzSize="small"
        [nzScroll]="{x:'1500px',y:'53vh'}"
      >
        <thead>
        <tr>
          <th nzLeft nzWidth="60px">stt
          </th>
          <th nzLeft nzWidth="200px">Ứng dụng
          </th>
          <th nzLeft nzWidth="200px">Tài khoản</th>
          <th nzWidth="200px">Hành động</th>
          <th>mô tả</th>
          <th nzWidth="200px">Địa chỉ máy</th>
          <th nzWidth="200px">Ngày</th>
        </tr>
        </thead>
        <tbody>
        <tr class="pointer" *ngFor="let systemHistory of tableSystemHistory.data; let i = index">
          <td nzLeft class="text-center">
            {{i + 1}}
          </td>
          <td nzLeft class="text-center">
            {{systemHistory?.appName ? (systemHistory.appName |transformApp:apps) : 'Chưa xác định'}}
          </td>
          <td nzLeft class="text-center">
            {{systemHistory.name}}
          </td>
          <td class="text-center">
            {{systemHistory.activity|transformMethod: methods}}
          </td>
          <td>
            {{systemHistory.description}}
          </td>
          <td class="text-center">
            {{systemHistory.ip}}
          </td>
          <td class="text-center">
            {{systemHistory.createdAt|date:'h:mm:ss a, dd-MM-yyyy'}}
          </td>
        </tr>
        <tr *ngIf='tableSystemHistory.data.length > 0'>
          <td [colSpan]="tableSystemHistory.listOfAutoColWidth.length">
            <div class="w-100 d-flex justify-content-start" style="position: relative">
              <button
                *ngIf="((count$ | async)|| 0) < ((total$ | async)|| 0)"
                [nzLoading]="(loadMore$|async)"
                (click)="onLoadMore()"
                style="position:sticky; left: 45vw"
                nz-button
                nzType="primary"
              >
                Tải thêm
              </button>
            </div>
          </td>
        </tr>
        </tbody>
      </nz-table>
    </div>
  </div>
</div>
