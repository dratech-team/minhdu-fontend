<div class="p-2 d-flex">
  <div class="d-flex flex-column mt-2">
    <div class="d-flex flex-column p-1" style=" height: 75vh; overflow-y: scroll">
      <mat-accordion>
        <mat-expansion-panel [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title class="font-weight-bold">
              Tìm kiếm
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div [formGroup]="formGroup">
            <input class="form-control" type="search" formControlName="search">
          </div>
        </mat-expansion-panel>
      </mat-accordion>
      <mat-accordion>
        <mat-expansion-panel class="mt-2" [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title class="font-weight-bold">
              Tổng mua
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div [formGroup]="formGroup">
            <div class="d-flex row justify-content-center align-items-center">
              <span class="col-1">Từ:</span>
              <input class="ml-3 form-control col">
            </div>
            <div class="d-flex row justify-content-center align-items-center mt-1">
              <span class="col-1">Đến:</span>
              <input class=" ml-3 form-control col">
            </div>
            <mat-form-field class="row" style="float: right">
              <mat-date-range-input [rangePicker]='picker'>
                <input matStartDate formControlName='startedAt' placeholder='Từ ngày'>
                <input matEndDate formControlName='endedAt' placeholder='Đến ngày'>
              </mat-date-range-input>
              <mat-datepicker-toggle matSuffix [for]='picker'></mat-datepicker-toggle>
              <mat-date-range-picker #picker></mat-date-range-picker>
            </mat-form-field>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
      <mat-accordion>
        <mat-expansion-panel class="mt-2" [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title class="font-weight-bold">
              Nợ hiện tại
            </mat-panel-title>
          </mat-expansion-panel-header>
          <div [formGroup]="formGroup">
            <div class="d-flex row justify-content-center align-items-center">
              <span class="col-1">Từ:</span>
              <input class="ml-3 form-control col">
            </div>
            <div class="d-flex row justify-content-center align-items-center mt-1">
              <span class="col-1">Đến:</span>
              <input class=" ml-3 form-control col">
            </div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
    <div class="mt-2"><span class="font-weight-bold">Tổng nhà cung cấp : {{total$|async}}</span></div>
  </div>
  <div class="mt-4">
    <div class="d-flex justify-content-between">
      <div class="font-weight-bold font-2xl ml-2">Nhà cung cấp</div>
      <button class="btn btn-primary" (click)="addProvider()">Thêm nhà cung cấp</button>
    </div>

    <div class="ml-2 mt-2" style="width: 78vw ; overflow: auto ; max-height: 70vh;">
      <table style="width: 100%;position: relative">
        <thead style="position: sticky; top: 0 ; z-index: 10">
        <tr>
          <td class="font-weight-bold">
            stt
          </td>
          <td class="font-weight-bold">
            Tên nhà cung cấp
          </td>
          <td class="font-weight-bold">
            Điện thoại
          </td>
          <td class="font-weight-bold">
            Email
          </td>
          <td class="font-weight-bold">
            Nợ cần trả hiện tại
          </td>
          <td class="font-weight-bold">
            Tổng mua
          </td>
        </tr>
        </thead>
        <tbody *ngIf="provider$|async as providers">
        <tr *ngIf='!(loaded$|async); else tableBranch'>
          <th colspan="100">
            <ngx-skeleton-loader count='10'
                                 appearance='line'></ngx-skeleton-loader>
          </th>
        </tr>
        <ng-template #tableBranch>
          <tr *ngFor="let provider of providers;let i = index"
              class="pointer"
              (contextmenu)='child.onContextMenu($event,provider)'>
            <th>
              <div>
                {{i + 1}}
              </div>
            </th>
            <th>
              <div>
                {{provider.name}}
              </div>
            </th>
            <th>
              <div>
                {{provider?.phone ? provider.phone : 'Chưa cập nhật'}}
              </div>
            </th>
            <th>
              <div>
                {{provider?.email ? provider.email : 'Chưa cập nhật' }}
              </div>
            </th>
            <th>
              <div style="color: red">
                {{provider.debt ? (provider.debt|number:'1.0-0') + 'đ' : 'Chưa cập nhật'}}
              </div>
            </th>
            <th>
              <div>
                {{provider.total ? (provider.total|number:'1.0-0') + 'đ' : 'Chưa cập nhật'}}
              </div>
            </th>
          </tr>
          <tr *ngIf='providers.length === 0' style='height: 50vh'>
            <td colspan='100' class='text-center check-content font-weight-bold font-xl relative '>
              <div class="d-flex justify-content-center align-items-center">
                <span>Hiện không có nhà cung cấp nào !</span>
              </div>
            </td>
          </tr>
        </ng-template>

        </tbody>
      </table>
    </div>
  </div>

</div>
<style>
  table thead td {
    background: white;
  }

  table tbody th div {
    display: flex;
    justify-content: center;
    align-content: center;
  }
</style>
<app-mouse-right #child
                 (onAdd)='addProvider()'
                 (onDel)='deleteProvider($event)'
                 (onUpdate)='updateProvider($event)'>
</app-mouse-right>
