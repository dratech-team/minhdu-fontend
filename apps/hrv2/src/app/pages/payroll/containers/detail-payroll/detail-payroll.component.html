<div class='row animated fadeIn mt-2' *ngIf='(payroll$ | async) as payroll'>
  <nz-carousel [nzEffect]="'effect'" [nzAutoPlay]='false' (nzBeforeChange)='navigatePayroll(payroll)'>
    <div nz-carousel-content *ngFor='let id of payroll.payrollIds'>
      <div style="max-width: 90vw ; margin: auto">
        <div class='row'>
          <div class='col-12 font-weight-bold font-lg text-center'>
            Phiếu lương tháng {{payroll.createdAt | date: 'MM/yyyy'}}
          </div>
          <div class='row col-md-12'>
            <div class=' col-4 pointer '>
              <div routerLink='/nhan-vien/chi-tiet-nhan-vien/{{payroll.employee.id}}'
                   class='employee row col-md-12 mt-3 d-flex flex-column align-items-center justify-content-center '
                   style='min-height: 116px; padding: 10px;background: white'>
                <div class='d-flex flex-column '>
                  <div class='d-flex justify-content-between font-weight-bold'>
                    <div class='ml-3'>{{payroll.employee.lastName}}</div>
                    <div (click)='updatePayroll(payroll); $event.stopPropagation()' style='background: #1b8eb7'
                         class='p-1 rounded'>
                      <img style='height: 10px; width:15px' src='/assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </div>
                  </div>
                  <div class='col-12 d-flex justify-content-start ' style='color: black'>
                    <span class='d-inline-block font-weight-bold'>Ngày tạo phiếu lương: </span>
                    <span class='ml-2 pointer border px-1 rounded'>{{payroll.createdAt|date: 'dd/MM/yyyy'}}</span>
                  </div>
                  <div class='col-12 d-flex justify-content-start ' style='color: black'>
                    <span class='d-inline-block font-weight-bold'>Ngày xác nhận phiếu lương: </span>
                    <span class='ml-2 pointer  px-1 rounded'>
                  {{(payroll.accConfirmedAt | date: 'dd/MM/yyyy') || 'Chưa xác nhận'}}
                </span>
                  </div>
                  <div class='col-12 d-flex justify-content-start ' style='color: black'>
                    <span class='d-inline-block font-weight-bold'>Đơn vị: </span>
                    <span class='ml-1'>{{payroll.branch}}</span>
                  </div>
                  <div class='col-12 d-flex justify-content-start ' style='color: black'>
                    <span class='d-inline-block font-weight-bold'>Lương thực nhân: </span>
                    <span class='ml-1'>
                      {{payroll.total.payroll
                      |roundingnumber :1000
                      |number:'1.0-0'
                      | notEmpty:'0'}}
                      đ</span>
                  </div>
                </div>
                <div class='d-flex mt-2'>
                  <div class="mr-2" style='width: 100%;'>
                    <div style='border-radius: 20px;height: 24px ;min-width: 150px;'>
                      <div class='col-md position btn btn-primary'>{{payroll.position}}</div>
                    </div>
                  </div>
                  <div class="ml-2" style='border-radius: 20px;height: 24px ;min-width: 150px;'>
                    <div class='position btn btn-primary'>
                      <span class='mr-2'>{{payroll.recipeType}}</span>|
                      <span class='ml-2'>{{payroll.employee.id}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div style='background: white' *ngIf='payroll.recipeType !== recipeType.CT3' class='employee row col mt-3 '>
              <div class='col' style='min-width: 170px'>
                <div class='row d-flex justify-content-center '>Ngày làm việc chuẩn</div>
                <div class='row content-title'>
                  {{payroll.workday}}
                </div>
              </div>
              <div class='col' style='min-width: 170px'>
                <div class='row justify-content-center'> Ngày làm việc thực tế</div>
                <div class='row content-title'>
                  {{payroll.actualday || payroll.totalWorkday || "0"}}
                </div>
              </div>
              <div class='col' style='min-width: 170px'>
                <div class='row d-flex justify-content-center '>Số ngày trong tháng</div>
                <div class='row content-title'>
                  {{daysInMonth}}
                </div>
              </div>
              <div class='col' style='min-width: 170px'>
                <div class='row justify-content-center mb-2'> Thuộc diện hợp đồng</div>
                <div class='row d-flex justify-content-center align-items-center mt-3'>
                  <div class='pointer' (click)='updateTaxed(payroll)'>
                    <nz-switch style='pointer-events: none' [ngModel]='payroll.taxed'></nz-switch>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='row' style='display: flex ; align-items: center'>
          <div class='col' style='border-top: 2px dashed #9FA2B4; margin: 50px 0;'></div>
        </div>
        <div class='row d-flex flex-column'
             *ngIf='payroll.recipeType !== recipeType.CT3; else seasonal'>
          <div #basic class='d-flex'>
            <!--Lương cơ bản-->
            <div class='col'>
              <table style="width: 100%">
                <thead>
                <tr>
                  <th>Lương cơ bản</th>
                  <th>Hệ số</th>
                  <th>Thành tiền</th>
                  <th width="100px" (click)='onAdd(salaryTypeEnum.BASIC,payroll)'>
                    <div class="d-flex">
                      <span class='mr-1 pointer' style='color: #1b8eb7'>Thêm mục</span>
                      <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                           alt='add icon'>
                    </div>
                  </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let salary of payroll.basics">
                  <td> {{salary.title}}</td>
                  <td> {{salary.rate}}</td>
                  <td class=' text-center ' style='color: #05981C'>
                    {{salary.price
                    | roundingnumber :1000
                    | number:'1.0'
                    | notEmpty:'0'}} đ
                  </td>
                  <td width='22%' class='col-md-2'>
                    <div class='d-flex justify-content-around'>
                      <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa '
                              class='edit animated mr-2'
                              (click)='updateSalary(salaryTypeEnum.BASIC,salary)'>
                        <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg'
                             alt='edit icon'>
                      </button>
                      <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                              (click)='removeSalary(salaryTypeEnum.BASIC, salary)'>
                        <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="font-weight-bold">Tổng cộng:</td>
                  <td></td>
                  <td style='color: #05981C'>
                    {{ payroll.total.basic
                    | roundingnumber :1000
                    | number: '1.0'
                    | notEmpty: '0' }} đ
                  </td>
                  <td></td>
                </tr>
                </tbody>
              </table>
            </div>
            <!--Phụ cấp lương-->
            <div class='col'>
              <table style="width: 100%">
                <thead style='background-color: white;'>
                <tr>
                  <th>
                    <div> Phụ cấp lương</div>
                  </th>
                  <th>
                    <div>Thành tiền</div>
                  </th>
                  <th width='100px' (click)='onAdd(salaryTypeEnum.STAY,payroll)'>
                    <div class="d-flex">
                      <span class='mr-1 pointer' style='color: #1b8eb7'>Thêm mục</span>
                      <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                           alt='add icon'>
                    </div>
                  </th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let salary of payroll.stays">
                  <td> {{salary.title}}</td>
                  <td style='color: #05981C'>
                    {{salary.price
                    | roundingnumber :1000
                    |number:'1.0'
                    |notEmpty:'0'}} đ
                  </td>
                  <td>
                    <div class='d-flex justify-content-around'>
                      <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa '
                              class='edit animated mr-2'
                              (click)='updateSalary(salaryTypeEnum.STAY,salary)'>
                        <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg'
                             alt='edit icon'>
                      </button>
                      <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                              (click)='removeSalary(salaryTypeEnum.STAY, salary)'>
                        <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="font-weight-bold">Tổng cộng :</td>
                  <td style='color: #05981C'>
                    {{payroll.total.stay
                    | roundingnumber :1000
                    | number: '1.0'
                    | notEmpty: '0' }} đ
                  </td>
                  <td></td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!--Phụ cấp -->
          <div #allowance class='mt-5 col-12'>
            <table style="width: 100%;">
              <thead>
              <tr>
                <th>
                  <div>Phụ cấp</div>
                </th>
                <th width='15%'>
                  <div>Thời gian</div>
                </th>
                <th>
                  <div>Tổng ngày</div>
                </th>
                <th width='100px'>
                  <div>Làm tại cty</div>
                </th>
                <th style="width: 150px">
                  <div>Theo ngày làm thực tế</div>
                </th>
                <th>
                  <div>Đơn giá</div>
                </th>
                <th>
                  <div>Thành tiền</div>
                </th>
                <th>
                  <div>Chú thích</div>
                </th>
                <th width='100px' style='padding: 0; color: #1b8eb7'
                    (click)='onAdd(salaryTypeEnum.ALLOWANCE, payroll ) '>
                  <div class="d-flex">
                    <span class='mr-1 pointer'>Thêm mục</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let salary of payroll.allowances">
                <td>
                  <span>{{salary.title}}</span>
                </td>
                <td>
                  Từ. {{ salary.startedAt | date:'dd-MM-yyyy' }}
                  <br/>
                  đến {{ salary.endedAt | date:'dd-MM-yyyy' }}
                </td>
                <td>
                  {{ salary.duration }}
                </td>
                <td>
                  <label nz-checkbox nzDisabled [nzChecked]="salary.inOffice"></label>
                </td>
                <td>
                  <label nz-checkbox nzDisabled [nzChecked]="salary.inWorkday"></label>
                </td>
                <td style='color: #05981C'>{{salary.price
                  | roundingnumber :1000
                  |number:'1.0'
                  | notEmpty:'0'}} đ
                </td>
                <td style='color: #05981C'>{{salary.total
                  | roundingnumber :1000
                  |number:'1.0'
                  | notEmpty:'0'}} đ
                </td>
                <td>
                  <span>{{salary?.note}}</span>
                </td>
                <td style="width: 100px">
                  <div class='d-flex justify-content-around '>
                    <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa ' class='edit animated'
                            (click)='updateSalary(salaryTypeEnum.ALLOWANCE, salary, payroll)'>
                      <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </button>
                    <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                            (click)='removeSalary(salaryTypeEnum.ALLOWANCE, salary)'>
                      <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="payroll.total.allowance">
                <td class="font-weight-bold">Tổng cộng :</td>
                <td></td>
                <td>{{payroll.total.allowance.duration.day}}</td>
                <td></td>
                <td></td>
                <td style='color: #05981C'>
                  {{payroll.total.allowance.price
                  | roundingnumber :1000
                  | number: '1.0'
                  | notEmpty: '0' }} đ
                </td>
                <td style='color: #05981C'>
                  {{payroll.total.allowance.total
                  | roundingnumber :1000
                  | number: '1.0'
                  | notEmpty: '0' }} đ
                </td>
                <td></td>
                <td></td>
              </tr>
              </tbody>
            </table>
          </div>
          <!--Tăng ca -->
          <div #overtime class='col-12 mt-5'>
            <nz-table
              style="
              border: solid 1px #EBEBEB !important;
              border-radius: 10px !important;
              box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.06) !important;"
              #tableOvertime
              [nzData]="payroll.overtimes"
              nzShowPagination="false"
            >
              <thead>
              <tr>
                <th nzWidth="60px"></th>
                <th nzWidth="60px">STT</th>
                <th>Tăng ca</th>
                <th>Thời gian</th>
                <th>Tổng ngày</th>
                <th>Thành tiền</th>
                <th>Chú thích</th>
                <th nzWidth='100px' style='padding: 0; color: #1b8eb7'
                    (click)='onAdd(salaryTypeEnum.OVERTIME, payroll ) '>
                  <div class="d-flex">
                    <span class='mr-1 pointer'>Thêm mục</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <ng-template ngFor let-salary [ngForOf]="tableOvertime.data" let-i='index'>
                <tr (click)='onSalarySetting(salary.setting.title)'>
                  <td (click)="$event.stopPropagation()" [(nzExpand)]="salary.expand"></td>
                  <td>
                    <span>{{i + 1}}</span>
                  </td>
                  <td>
                    <div>
                      <span>{{salary.setting.title}}</span>
                      <span class='ml-2' *ngIf='salary.allowance'> + {{salary.allowance.title}}</span>
                    </div>
                  </td>
                  <td class=' text-center '>
                    Từ  {{salary.startedAt | date:'dd-MM-yyyy'}}
                    <br> đến {{salary.endedAt | date:'dd-MM-yyyy'}}
                  </td>
                  <td>
                    {{salary.duration}} {{ salary.partial | transformconstant: sessionConstant}}
                  </td>
                  <td style='color: #05981C'>
                <span>
                  {{ salary.total
                  | roundingnumber :1000
                  | number:'1.0'}} đ
                </span>
                  </td>
                  <td>
                    <span>{{salary.note}}</span>
                  </td>
                  <td>
                    <div class='d-flex justify-content-around '>
                      <button data-placement='top' title=' chỉnh sửa ' class='edit animated'
                              (click)='updateSalary(salaryTypeEnum.OVERTIME, salary); $event.stopPropagation()'>
                        <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                      </button>
                      <button title='xóa' class='trash animated'
                              (click)='removeSalary( salaryTypeEnum.OVERTIME, salary); $event.stopPropagation()'>
                        <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr [nzExpand]="salary.expand">
                  <nz-table
                    #innerTable
                    [nzData]="salary.details"
                    nzSize="small"
                    nzShowPagination="false"
                  >
              <thead>
              <tr>
                <th>Ngày</th>
                <th>Tổng ngày</th>
                <th>Hệ số</th>
                <th>Đơn giá</th>
                <th>Thành tiên</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let item of innerTable.data">
                <td style="background: white">{{item.datetime | date:'dd-MM-yyyy'}}</td>
                <td style="background: white">{{item.duration}}</td>
                <td style="background: white">{{item.rate}}</td>
                <td style="background: white">
                  {{item.price
                  | roundingnumber :1000
                  | number:'1.0-0'}} đ
                </td>
                <td style="background: white">{{item.total | number:'1.0-0'}}</td>
              </tr>
              </tbody>
            </nz-table>
            </tr>
            </ng-template>
            <tr *ngIf='payroll.overtimes?.length > 0'>
              <td></td>
              <td></td>
              <td class="font-weight-bold">Tổng cộng :</td>
              <td></td>
              <td>
                {{payroll.total.overtime.duration.day}} ngày
                <br>{{payroll.total.overtime.duration.hour}} Giờ
              </td>
              <td style='color: #05981C'>
                {{payroll.total.overtime.total
                | roundingnumber :1000
                | number: '1.0'
                | notEmpty: '0' }} đ
              </td>
              <td></td>
              <td></td>
            </tr>
            </tbody>
            </nz-table>
          </div>
          <!--Vắng-->
          <div #absent class='col-12 mt-5'>
            <table>
              <thead>
              <tr>
                <th width='60px'>
                  <div>STT</div>
                </th>
                <th width="20%">
                  <div>Loại vắng</div>
                </th>
                <th width="13%">
                  Thời gian
                </th>
                <th>
                  Tổng ngày
                </th>
                <th>
                  Đơn giá
                </th>
                <th>
                  <div>
                    Thành tiền
                  </div>
                </th>
                <th>
                  <div>
                    Chú thích
                  </div>
                </th>
                <th width='100px' style='padding: 0; color: #1b8eb7'
                    (click)='onAdd(salaryTypeEnum.ABSENT, payroll ) '>
                  <div class="d-flex">
                    <span class='mr-1 pointer'>Thêm mục</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let salary of payroll.absents; let i = index"
                  class='pointer'
                  (click)='onSalarySetting(salary?.setting?.title)'>
                <td>
                  {{i + 1}}
                </td>
                <td>
                  <div>
                    <span>{{salary.title}}</span>
                  </div>
                </td>
                <td>
              <span *ngIf='salary.startedAt && salary.endedAt'>
              Từ. {{salary.partial !== PartialDay.CUSTOM ? (salary.startedAt | date:'dd-MM-yyyy') : salary.startedAt | date:'dd-MM-yyyy HH:mm:ss'}}
                <br/>
                đến {{salary.partial !== PartialDay.CUSTOM ? (salary.endedAt | date:'dd-MM-yyyy') : salary.endedAt | date:'dd-MM-yyyy HH:mm:ss'}}
                </span>
                </td>
                <td>
                  {{salary.duration}} {{salary.partial | transformconstant:sessionConstant}}
                </td>
                <td>
                    <span style='color: red'>
                      {{salary.price
                      | roundingnumber :1000
                      | number:'1.0-0'}} đ
                    </span>
                </td>
                <td>
                    <span style='color: red'>
                      {{salary.total
                      | roundingnumber :1000
                      | number:'1.0-0'}} đ
                    </span>
                </td>
                <td>
                  <span>{{salary.note}}</span>
                </td>
                <td>
                  <div class='d-flex justify-content-around '>
                    <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa ' class='edit animated'
                            (click)='updateSalary(salaryTypeEnum.ABSENT, salary); $event.stopPropagation()'>
                      <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </button>
                    <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                            (click)='removeSalary(salaryTypeEnum.ABSENT, salary); $event.stopPropagation()'>
                      <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
                <td></td>
                <td class="font-weight-bold">Tổng cộng :</td>
                <td></td>
                <td>
                  {{payroll.total.absent.duration.day}} ngày
                  <br>{{payroll.total.absent.duration.hour}} Giờ
                </td>
                <td style='color: #05981C'>
                  {{payroll.total.absent.price
                  | roundingnumber :1000
                  | number: '1.0-0'
                  | notEmpty: '0' }} đ
                </td>
                <td style='color: #05981C'>
                  {{payroll.total.absent.total
                  | roundingnumber :1000
                  | number: '1.0-0'
                  | notEmpty: '0' }} đ
                </td>
                <td></td>
                <td></td>
              </tr>
              </tbody>
            </table>
          </div>
          <!--Khấu trừ-->
          <div #absent class='col-12 mt-5'>
            <table>
              <thead>
              <tr>
                <th width='3%'>
                  <div>STT</div>
                </th>
                <th>
                  <div>Khấu trừ</div>
                </th>
                <th>
                  <div>
                    Thành tiền
                  </div>
                </th>
                <th>
                  <div>
                    Chú thích
                  </div>
                </th>
                <th width='100px' style='padding: 0; color: #1b8eb7'
                    (click)='onAdd(salaryTypeEnum.DEDUCTION, payroll)'>
                  <div class="d-flex">
                    <span class='mr-1 pointer'>Thêm mục</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr class='pointer' *ngFor="let salary of payroll.deductions; let i = index">
                <td>
                  {{i + 1}}
                </td>
                <td>
                  <div>
                    <span>{{salary.title}}</span>
                  </div>
                </td>
                <td>
                    <span style='color: red'>
                      {{salary.price | number:'1.0-0'}} đ
                    </span>
                </td>
                <td>
                  <span>{{salary.note}}</span>
                </td>
                <td>
                  <div class='d-flex justify-content-around '>
                    <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa ' class='edit animated'
                            (click)='updateSalary(salaryTypeEnum.DEDUCTION, salary); $event.stopPropagation()'>
                      <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </button>
                    <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                            (click)='removeSalary(salaryTypeEnum.DEDUCTION, salary); $event.stopPropagation()'>
                      <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="payroll.total.remote">
                <td></td>
                <td class="font-weight-bold">Tổng cộng :</td>
                <td>
                  {{payroll.total.deduction
                  | roundingnumber :1000
                  |number:'1.0-0'
                  }} đ
                </td>
                <td></td>
                <td></td>
              </tr>
              </tbody>
            </table>
          </div>
          <!--ngày lễ-->
          <div #holiday class='col-12 mt-5'>
            <table style="width: 100%">
              <thead>
              <tr>
                <th nzWidth='3%'>STT</th>
                <th nzWidth='22%'>Đi làm ngày lễ</th>
                <th nzWidth='15%'>Đơn vị</th>
                <th nzWidth='9%'>Hệ số</th>
                <th nzWidth='15%'> Đơn giá</th>
                <th nzWidth='15%'>Tổng tiền</th>
                <th style='color: #1b8eb7; width: 100px' (click)='onAdd(salaryTypeEnum.HOLIDAY, payroll)'>
                  <div class="d-flex">
                    <span class='mx-2 pointer'>Thêm</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let salary of payroll.holidays; let i = index "
                  (click)="onSalarySetting(salary.setting.title)"
                  style='background: white !important;'>
                <td>
                  {{i + 1}}
                </td>
                <td class=' text-center'>
                  Từ. {{(salary.setting.startedAt | date:'dd-MM-yyyy')}}
                  <br/>
                  đến {{(salary.setting.endedAt | date:'dd-MM-yyyy')}}
                </td>
                <td class=' text-center'>
                  ngày
                </td>
                <td class=' text-center'>
                  <span>{{salary.setting.rate}}</span>
                </td>
                <td class=' text-center'>
                  {{
                  ((salary.setting.prices && salary.setting.prices.length > 0
                      ? (salary.setting.prices|prices)
                      : (salary.setting.totalOf|salarytype:'transform'))
                    + (salary.setting.workday
                        ? +' / ' + salary.setting.workday
                        : '/ Ngày công chuẩn'
                    )
                  )
                  }}
                </td>
                <td>
                  {{ salary.total
                  | roundingnumber :1000
                  | number:'1.0'}} đ
                </td>
                <td (click)="$event.stopPropagation()">
                  <div class='d-flex justify-content-around '>
                    <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa ' class='edit animated'
                            (click)='updateSalary(salaryTypeEnum.HOLIDAY, salary)'>
                      <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </button>
                    <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                            (click)='removeSalary(salaryTypeEnum.HOLIDAY, salary)'>
                      <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="payroll.total.holiday">
                <td></td>
                <td class="font-weight-bold">Tổng cộng :</td>
                <td>
                  {{payroll.total.holiday.duration}} ngày
                </td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              </tbody>
            </table>
          </div>
          <!--WFH-->
          <div #absent class='col-12 mt-5'>
            <table style="width: 100%">
              <thead>
              <tr>
                <th width='3%'>
                  STT
                </th>
                <th>
                  Remote/Onsite/WFH
                </th>
                <th>
                  Thời gian
                </th>
                <th>
                  Tổng ngày
                </th>
                <th>
                  Chi tiết
                </th>
                <th>
                  Diễn giải
                </th>
                <th width='100px' style='padding: 0; color: #1b8eb7'
                    (click)='onAdd(salaryTypeEnum.WFH, payroll ) '>
                  <div class="d-flex">
                    <span class='mr-1 pointer'>Thêm mục</span>
                    <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let salary of payroll.remotes;let i=index ">
                <td>
                  <span>{{i + 1}}</span>
                </td>
                <td>
                  <span>{{salary.type | transformconstant: remoteConstant}}</span>
                </td>
                <td>
                 <span>
                 từ {{salary.startedAt | date:'dd-MM-yyyy'}}
                   <br>
                   đến  {{salary.endedAt | date:'dd-MM-yyyy'}}
                </span>
                </td>
                <td>
                  {{salary.duration}} {{salary.partial | transformconstant: sessionConstant}}
                </td>
                <td></td>
                <td>
                  <span>{{salary.note}}</span>
                </td>
                <td>
                  <div class='d-flex justify-content-around '>
                    <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa ' class='edit animated'
                            (click)='updateSalary(salaryTypeEnum.WFH, salary)'>
                      <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg' alt='edit icon'>
                    </button>
                    <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                            (click)='removeSalary(salaryTypeEnum.WFH, salary)'>
                      <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
                <td></td>
                <td class="font-weight-bold">Tổng cộng :</td>
                <td></td>
                <td>
                  {{payroll.total.remote.duration
                  | roundingnumber :1000
                  | number:'1.0-0'
                  }} ngày
                </td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              </tbody>
            </table>
          </div>
          <!--chú thích-->
          <div #note class='col-12 mt-5'>
            <table>
              <thead>
              <tr>
                <th> Chú thích phiếu lương</th>
                <th width='100px' style='color: #1b8eb7' (click)='addOrUpdateNote(payroll)'>
                  <div class="d-flex">
                    <span class='mx-2 pointer'>{{payroll?.note ? 'Sửa' : 'Thêm'}}</span>
                    <img class='pointer' style='margin-left: 2px;width: 13px;' src='./assets/img/payroll/plus-lg.svg'
                         alt='add icon'>
                  </div>
                </th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>
                  <span>{{payroll.note || "Chưa có chú thích"}}</span>
                </td>
                <td width='10%'></td>
              </tr>
              </tbody>
            </table>
          </div>

          <div class='sticky-scroll' *ngIf='isSticky'>
            <div class='pointer' (click)='onSticky(sticky)'>Ẩn >></div>
            <div class='pointer ' (click)='scroll(basic,sticky)'>Lương cơ bản</div>
            <div class='pointer' (click)='scroll(basic,sticky)'>Phụ cấp lương</div>
            <div class='pointer' (click)='scroll(allowance,sticky)'>Phụ cấp</div>
            <div class='pointer' (click)='scroll(overtime,sticky)'>Tăng ca</div>
            <div class='pointer' (click)='scroll(absent,sticky)'>Khấu trừ</div>
            <!--            <div class='pointer' (click)='scroll(holiday,sticky)'>Đi làm ngày lễ</div>-->
            <div class='pointer' (click)='scroll(note,sticky)'>Chú thích</div>
            <div class='pointer' (click)='scroll(footer,sticky)'>Lịch sử và xác nhận lương</div>
          </div>
          <div class='sticky-scroll' #sticky>
            <div class='pointer' (click)='onSticky(sticky)'>
              << Hiện
            </div>
          </div>
        </div>
        <ng-template #seasonal>
          <div class='row d-flex flex-column'>
            <div class='d-flex'>
              <div class='col-12'>
                <nz-table>
                  <thead>
                  <tr style='background-color: #dddddd66;'>
                    <th>
                      <div>Lương công nhật</div>
                    </th>
                    <th>
                      <div>
                        Thời gian
                      </div>
                    </th>
                    <th>
                      <div>
                        Đơn giá
                      </div>
                    </th>
                    <th>
                      <div>
                        Thành tiền
                      </div>
                    </th>
                    <th nzWidth='12%' (click)='onAdd(salaryTypeEnum.PART_TIME,payroll)'>
                      <div class="d-flex">
                        <span class='mr-1 pointer' style='color: #1b8eb7'>Thêm mục</span>
                        <img style='margin-left: 2px;width: 10px;' src='../../../../../assets/img/payroll/plus-lg.svg'
                             alt='add icon'>
                      </div>
                    </th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr style='background: white'
                      *ngFor="let salary of payroll.salaries | filterSalary:['PART_TIME','OVERTIME'] ">
                    <td> {{salary.title}} {{salary?.allowance ? '+ ' + salary.allowance.title : ''}}</td>
                    <td class='text-center'>
                      {{salary.times}} {{salary.unit === 'DAY' ? 'ngày' : 'giờ' }}
                      {{salary?.datetime ? ' ngày ' + (salary.datetime|date:'dd/MM/yyyy') : ''}}
                    </td>
                    <td class=' text-center '>
                      {{salary.price|number:'1.0'|notEmpty:'0'}} đ
                      {{salary.allowance ? '+ ' + (salary.allowance.price|number:'1.0'|notEmpty:'0') + ' đ' : ''}}
                    </td>
                    <td class=' text-center ' style='color: #4B3880'>
                  <span *ngIf='!salary.allowance; else total'>
                     {{salary.price * salary.times|number:'1.0'|notEmpty:'0'}} đ
                  </span>
                      <ng-template #total>
                      <span>
                     {{salary.price * salary.times +
                      salary.allowance.price
                        | roundingnumber :1000
                        |number:'1.0'
                        |notEmpty:'0'}} đ
                  </span>
                      </ng-template>
                    </td>
                    <td nzWidth='10%'>
                      <div class='d-flex justify-content-around'>
                        <button data-toggle='tooltip' data-placement='top' title=' chỉnh sửa '
                                class='edit animated mr-2'
                                (click)='updateSalary(salaryTypeEnum.PART_TIME,salary)'>
                          <img style='height: 9px;' src='../../../../../assets/img/share/pencil-fill.svg'
                               alt='edit icon'>
                        </button>
                        <button data-toggle='tooltip' data-placement='top' title='xóa' class='trash animated'
                                (click)='removeSalary(salaryTypeEnum.PART_TIME, salary)'>
                          <img style='height: 9px;' src='../../../../../assets/img/payroll/trash.svg' alt='delete icon'>
                        </button>
                      </div>
                    </td>
                  </tr>
                  </tbody>
                </nz-table>
              </div>
            </div>
          </div>
        </ng-template>

        <div class='col-md-12' style='border-top: 2px dashed #9FA2B4; margin: 50px 0;'>
        </div>
        <div #footer>
          <div class='col-md-12' *ngIf='(payroll$ | async) as payroll' style='display: flex; justify-content: flex-end'>

            <button
              (click)='deletePayroll(payroll)'
              class='btn btn-danger mr-3' style='height: 35px'>
              Xóa phiếu lương
            </button>
            <button (click)='historySalary(payroll)'
                    class='mb-5 btn d-flex d-flex justify-content-center  align-items-center mr-3'
                    style='border: solid 1px #4B3880'>
              <img class='mr-1' src='../../../../../assets/img/share/arrow-counterclockwise.svg' alt='history'><span>xem
            lịch
            sử lương</span>
            </button>
            <button (click)='confirmPayroll(payroll)' class='mb-5 create-salary'>
              <img class='mr-2' style='height: 12px;' src='../../../../../assets/img/share/pencil-fill.svg'
                   alt='edit icon'>
              {{role === roleEnum.HUMAN_RESOURCE ? 'Khôi phục phiếu lương' : 'Xác nhận phiếu lương'}}
            </button>
          </div>
        </div>
      </div>
    </div>
  </nz-carousel>
</div>
<nz-spin *ngIf="(scanned$ | async) === false" nzSize="large" style="position: fixed; top:50%; left: 50% ">
</nz-spin>
<style>

</style>
