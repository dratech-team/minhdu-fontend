<!--<ngx-skeleton-loader *ngIf='!(loaded$ | async)  ; else payroll'-->
<!--                     count='18' appearance='line'></ngx-skeleton-loader>-->

<div class='table-scroll mt-2'
     infiniteScroll
     [alwaysCallback]='true'
     [infiniteScrollDistance]='1'
     [infiniteScrollThrottle]='10'
     [scrollWindow]='false'
     (scrolled)='onScroll()'>
  <table [formGroup]='formGroup' class='main-table' style='width: 4000px'>
    <thead>
    <tr>
      <th style='width: 150px;'>
        <div class='border-top text-center'>Mã phiếu lương</div>
        <input type='text' disabled>
      </th>
      <th style='width: 250px'>
        <div class='border-top text-center'>Tên nhân viên</div>
        <input class='form-control text-center' placeholder='Nhập tên nhân viên' type='text'
               formControlName='name'>
      </th>
      <th style='width: 200px'>
        <div class='border-top text-center'>Ngày công chuẩn</div>
        <input class='form-control text-center' type='number' disabled>
      </th>
      <th>
        <div class=' text-center'>Chức vụ</div>
        <input class='form-control' type='text' matInput [matAutocomplete]='position'
               formControlName='position'>
        <mat-autocomplete #position='matAutocomplete'>
          <mat-option *ngFor='let position of positions$ | async' [value]='position.name'
                      (click)='onSelectPosition(position.name)'
                      (onSelectionChange)='onSelectPosition(position.name)'>
            {{position.name}}
          </mat-option>
        </mat-autocomplete>
      </th>
      <th width='3%'>
        <div class='text-center'>Tháng</div>
        <input class='form-control' type='month' formControlName='createdAt' min='2021-01'>
      </th>
      <th *ngFor='let item of daysInMonth'> {{item.title|date:'EEE dd/MM'}}</th>
      <th width='3%'>
        <div class='text-center'>Tổng công</div>
      </th>
      <th width='4%'>
        <div class='text-center'>Quản lý xác nhận</div>
        <select style='width: 100%' class='select border-top' matNativeControl required
                formControlName='manConfirmedAt'>
          <option value='TRUE'>Đã xác nhận</option>
          <option value='FALSE'>chưa xác nhận</option>
          <option value=''>Mặc định</option>
        </select>
      </th>
    </tr>
    </thead>
    <tbody *ngIf='(payroll$|async) as payrolls' >
    <tr *ngFor='let payroll of payrolls; let i = index'
        (contextmenu)='child.onContextMenu($event,payroll)'>
      <th class='pointer fixed-side text-center' (click)='readPayroll(payroll)'
          [ngClass]='{"odd": i % 2 === 0, "even": i % 2 !== 0 }'>
        {{payroll.id}}
      </th>
      <th class='pointer text-center' (click)='readPayroll(payroll)'
          [ngClass]='{"odd": i % 2 === 0, "even": i % 2 !== 0 }'>
        {{payroll?.employee?.firstName}}  {{payroll?.employee?.lastName}}
      </th>
      <th class='pointer fixed-side text-center ' (click)='readPayroll(payroll)'
          [ngClass]='{"odd": i % 2 === 0, "even": i % 2 !== 0 }'>
        {{payroll?.employee?.workday}}
      </th>
      <th class='pointer text-center' (click)='readPayroll(payroll)'>
        {{payroll.employee?.position?.name}}
      </th>
      <th class='pointer text-center' (click)='readPayroll(payroll)'>
        {{payroll.createdAt|date:'yyyy-MM'}}
      </th>
      <th class='text-center' *ngFor='let item of daysInMonth ; let i = index' (click)='readPayroll(payroll)'
          [ngStyle]='{"color": payroll.timesheet ? payroll.timesheet.datetime[i]["color"] : "black" }'>
        {{payroll?.timesheet ? payroll.timesheet.datetime[i][item.key] : ''}}
      </th>
      <th class='pointer text-center' (click)='readPayroll(payroll)'>
        {{payroll?.timesheet?.total}}
      </th>
      <th class='pointer text-center'>
        <div (click)='updateManConfirm(payroll.id,payroll.manConfirmedAt, payroll.createdAt)'
             style='height: fit-content'>
          <input style='pointer-events: none' disabled type='checkbox'
                 [checked]='payroll.manConfirmedAt !== null'>
        </div>
      </th>
    </tr>
    <tr *ngIf='payrolls.length === 0' style='height: 50vh'>
      <td colspan='100' class='text-center check-content font-weight-bold font-xl '>
        <span style='position: absolute ; top: 50%; left: 50%'> Hiện không có Phiếu chấm công nào !</span>
      </td>
    </tr>
    </tbody>
  </table>
</div>
  <app-mouse-right [type]='pageType.RESTORE'
                   #child
                   (addEvent)='addPayroll($event)'
                   (restore)='restorePayroll($event)'
                   (readAndUpdateEvent)='readPayroll($event)'>
  </app-mouse-right>

